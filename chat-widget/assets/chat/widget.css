:root {
  --chat-accent: #4f46e5;      /* overwritten by JS from config.accent */
  --chat-radius: 18px;         /* softened, rounded look */
  --chat-shadow: 0 10px 36px rgba(0,0,0,.18), 0 6px 16px rgba(0,0,0,.12);

  --chat-bg: #ffffff;
  --chat-fg: #0f172a;
  --chat-muted: #64748b;
  --chat-border: #4a64a5;

  /* Bubble colors (inspired by your second screenshot) */
  --bubble-bot-bg: #374a64;     /* deep slate/blue (assistant) */
  --bubble-bot-fg: #ffffff;
  --bubble-bot-border: rgba(13,25,47,.5);

  --bubble-user-bg: rgba(238,242,247,.95); /* light for contrast (user) */
  --bubble-user-fg: #0b1220;
  --bubble-user-border: rgba(30,46,80,.25);

  /* Input bar (inspired by your first screenshot) */
  --input-bg: rgba(17,24,39,.65);   /* translucent dark */
  --input-fg: #e5e7eb;
  --input-border: rgba(148,163,184,.35);
  --placeholder: rgba(229,231,235,.55);
}

@media (prefers-color-scheme: dark) {
  :root {
    --chat-bg: #0b1220;
    --chat-fg: #e5e7eb;
    --chat-muted: #9aa4b2;
    --chat-border: #1f2a44;

    --bubble-bot-bg: #2f425d;
    --bubble-bot-fg: #ffffff;
    --bubble-bot-border: rgba(114,144,196,.35);

    --bubble-user-bg: rgba(255,255,255,.10);
    --bubble-user-fg: #eaeef7;
    --bubble-user-border: rgba(160,176,208,.28);

    --input-bg: rgba(10,14,24,.65);
    --input-fg: #e5e7eb;
    --input-border: rgba(148,163,184,.28);
    --placeholder: rgba(229,231,235,.5);
  }
}

/* ---------- Launcher button ---------- */
.cw-launcher {
  position: fixed;
  right: 22px;
  bottom: 22px;
  z-index: 2147483646;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 64px;
  height: 64px;
  border: none;
  border-radius: 999px;
  background: var(--chat-accent);
  color: #fff;
  box-shadow: var(--chat-shadow);
  cursor: pointer;
  transition: transform .15s ease, box-shadow .15s ease, opacity .2s ease;
}
.cw-launcher:hover { transform: translateY(-2px); }
.cw-launcher:active { transform: translateY(0); }
.cw-launcher:disabled { opacity:.6; cursor:not-allowed; }
.cw-launcher svg { width: 28px; height: 28px; }

/* ---------- Panel shell ---------- */
.cw-wrap {
  position: fixed;
  right: 22px;
  bottom: 94px;
  z-index: 2147483646;
  width: 360px;
  max-height: calc(100vh - 140px);
  border-radius: 20px;
  background: var(--chat-bg);
  color: var(--chat-fg);
  box-shadow: var(--chat-shadow);
  display: none;                /* toggled by JS */
  overflow: hidden;
  border: 1px solid var(--chat-border);
}

@media (max-width: 480px) {
  .cw-wrap {
    right: 12px;
    left: 12px;
    width: auto;
    bottom: 88px;
    max-height: calc(100vh - 120px);
  }
}

/* ---------- Header ---------- */
.cw-head {
  position: relative;
  background: #2a2f3a;  /* dark grey */
  color: #fff;
  padding: 14px 16px;
}
.cw-title {
  font-weight: 700;
  letter-spacing:.2px;
  margin: 0 0 4px 0;
  font-size: 16px;
}
.cw-sub {
  margin: 0;
  opacity: .9;
  font-size: 12px;
}
.cw-close {
  position:absolute;
  right:10px; top:10px;
  width:34px; height:34px;
  border:none; border-radius:999px;
  display:inline-flex; align-items:center; justify-content:center;
  background: rgba(255,255,255,.22);
  color:#fff; cursor:pointer;
  transition: background .15s ease, transform .15s ease;
}
.cw-close:hover { background: rgba(255,255,255,.3); transform: translateY(-1px); }

/* ---------- Body / messages ---------- */
.cw-body {
  display:flex;
  flex-direction:column;
  height: 420px;               /* reliable open/close behavior */
  background: var(--chat-bg);
}
.cw-scroll {
  padding: 14px 14px 6px;
  overflow: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

/* bubbles */
.cw-row { display:flex; gap:10px; }
.cw-row.user { justify-content:flex-end; }

.cw-bubble {
  max-width: 86%;
  border-radius: 22px;                 /* pill-like bubbles */
  padding: 12px 14px;
  line-height: 1.5;
  border: 1px solid var(--chat-border);
  font-size: 14px;
  white-space: pre-wrap;
  overflow-wrap: anywhere;
  word-break: break-word;
}

/* Assistant (my) bubbles */
.cw-row.bot .cw-bubble {
  background: var(--bubble-bot-bg);
  color: var(--bubble-bot-fg);
  border-color: var(--bubble-bot-border);
}

/* User bubbles */
.cw-row.user .cw-bubble {
  background: var(--bubble-user-bg);
  color: var(--bubble-user-fg);
  border-color: var(--bubble-user-border);
}

/* ---------- Reader-friendly assistant formatting ---------- */
.cw-row.bot .cw-bubble p { margin: 6px 0; }
.cw-row.bot .cw-bubble ul { margin: 6px 0 2px; padding-left: 18px; }
.cw-row.bot .cw-bubble li { margin: 4px 0; }
.cw-row.bot .cw-bubble strong { font-weight: 700; }

/* ---------- Input row (pill + corner send icon) ---------- */
.cw-input {
  position: relative;
  display:flex;
  gap:10px;
  padding: 12px;
  border-top: 1px solid var(--chat-border);
  background: color-mix(in srgb, var(--chat-bg) 92%, #000 8%);
}

/* Text area (hybrid: expands a bit, wide, pill) */
.cw-input textarea,
.cw-input input[type="text"] {
  flex: 1 1 auto;
  outline: none;
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--input-fg);
  border-radius: 16px;
  padding: 12px 56px 12px 14px;  /* right padding leaves room for icon */
  font-size: 14px;
  line-height: 1.4;

  height: 52px;
  min-height: 52px;
  max-height: 120px;             /* used by textarea version */
  overflow-y: auto;
  resize: none;
}

.cw-input textarea::placeholder,
.cw-input input[type="text"]::placeholder {
  color: var(--placeholder);
}

/* Send button â€” compact, sits inside bottom-right corner */
.cw-send {
  min-width: 46px;
  height: 46px;
  border: none;
  border-radius: 50%;
  background: var(--chat-accent);
  color: #fff;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background .2s ease;
}

.cw-send:hover {
  background: #2a2f3a; /* match header on hover */
}

.cw-send svg {
  width: 18px;
  height: 18px;
  display: block;
  fill: currentColor;
  pointer-events: none;
}

/* ---------- System row (errors, tips) ---------- */
.cw-note {
  margin: 8px 14px 0;
  font-size: 12px;
  color: var(--chat-muted);
}

/* ---------- Typing dots ---------- */
.cw-typing {
  display:inline-flex; gap:3px; align-items:center;
}
.cw-dot {
  width:6px; height:6px; border-radius:999px; background: var(--chat-muted);
  animation: cw-blink 1s infinite ease-in-out;
}
.cw-dot:nth-child(2){ animation-delay:.15s }
.cw-dot:nth-child(3){ animation-delay:.3s }
@keyframes cw-blink { 0%,80%,100%{opacity:.35} 40%{opacity:1} }

/* ---------- Utility ---------- */
.cw-hidden { display:none !important; }

/* === Chat Box Tweaks === */

/* Bot bubble (Tony) */
.cw-row.bot .cw-bubble {
  background: #374a64;       /* deep navy */
  color: #ffffff;
  border: 1px solid #2a3950; /* slim dark border */
}

/* User bubble */
.cw-row.user .cw-bubble {
  background: #dce3f3;       /* mid-light blue/gray */
  color: #0b1220;
  border: 1px solid #b3c0d8; /* subtle lighter border */
}

/* Slightly taller chat window */
.cw-body {
  height: 460px; /* was 420px */
}
/* === Light Theme Tweaks === */

/* Header bar */
.cw-head {
  background: #f2f3f5;   /* lighter grey header */
  color: #111;           /* dark text for contrast */
}

/* Input row background */
.cw-input {
  background: #f8f9fb;   /* very light grey */
}

/* Send button (lighter circle + grey icon) */
.cw-send {
  min-width: 46px;
  height: 46px;
  border: none;
  border-radius: 50%;
  background: #e0e2e7;   /* light grey button background */
  color: #555;           /* medium grey icon */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background .2s ease, color .2s ease;
}

.cw-send:hover {
  background: #d5d8dd;   /* slightly darker on hover */
  color: #333;
}


/* Safety: ensure launcher is visible */
.cw-launcher { display: inline-flex !important; }
